---
title: 差分放大
date: 2025-03-17 20:38:56
mathjax: true
categories:
  - 硬件
  - 模电
tags:
---

# 差分放大
我们日常使用的信号源一般是两根线传输，一个地线，一根是信号线，这种信号叫做单端信号。
单端信号在远距离传输过程中，不可避免的要受到外界电场的干扰，而差分信号抗干扰性很强。

定义1：差分信号中两个信号线之间的差值信号，用u<sub>D</sub>表示：$u_D = u_{s+}-u_{s-}$

定义2：差分信号中两个信号线共有的信号，称为共模信号，用u<sub>C</sub>表示：$u_C = 0.5（u_{s+}+u_{s-}）$

在远距离传输过程中，因为两根线两根线距离很近，两根线都收到了相同的外界干扰。此时，差模信号是待测的有用信号，而共模信号是干扰。如果有一个差动放大器，他有两个输入端和两个输出端，而真正有意义的输出是两个输出端的差值。

## 差动放大器
先在仿真软件中模拟出差模和共模信号，电路图如下所示：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.2vewiworjx.webp)

信号源通过两个压控电压源（放大倍数均为0.5）正极输出和负极输出模拟差分信号，共模信号接在两个压控电压源之间。则

$$
\begin{align*}\left\{\begin{aligned}u_{S+} &= u_1 + 0.5u_D \\u_{S-} &= u_1 - 0.5u_D\end{aligned}\right.\end{align*}
$$

当关闭共模信号输入时可以用示波器看到，输入与差分信号的关系：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.26lmzwu1ma.webp)
每一路信号都是输入信号的0.5倍，VF2是VF3的反相信号，$VF3-VF2$正好是原信号

当接入共模信号时，可以看到每一路差分信号都是在共模信号的基础上叠加的。
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.8z6omdpalg.webp)

假设我们可以造出一个放大器，它能够实现分别放大两路差分信号，最后再把两个输出信号相减得到放大的有用信号。

差动放大电路如下图所示：
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6t7a0n2yc1.webp)

我们用示波器看Vin+和Vout+的结果，看信号是否被放大

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6bh8c2a0c5.webp)

Vout+信号是Vin+放大后的结果，但是又有点奇怪，因为我们还没有对Vout+和Vout-相减，它的输出就已经没有共模信号了，这是为什么？这正与我们期望的一样，我们希望差动放大电路可以放大差模信号，抑制共模信号。下面是理论分析：

因为电路是线性电路，符合叠加原理，我们只看共模信号输入。首先按照分析步骤，先进行静态分析确定I<sub>BQ1</sub>，假设两边电路对称，只分析Q1管子：

$$
I_{B01}R_{B1} + 0.7\,\text{V} + 2(1 + \beta)I_{B01}R_E = 0\,\text{V} - (-V_{EE}) = 12\,\text{V}
$$
解出$I_{BQ1} = 55.67μA$，$r_{be1}≈\frac{U_T}{I_{BQ1}}=0.467kΩ$

动态分析我们直接不画动态等效图了，开始脑内脑补，基极电阻就只有RB1和r<sub>be</sub>，需要注意发射极是两个管子射极电流并入到一个RE中，所以：

$$i_{b\_com} = \frac{V_{com}}{R_{B1} + r_{be} + 2(1 + \beta)R_E}$$

$$u_{out+com} = -βi_{b\_com}R_{C1}$$


得到单端共模放大倍数：
$$A_{C \text{单}} = \frac{u_{O+\_com}}{V_{com}} = -\frac{\beta R_{C1}}{R_{B1} + r_{be} + 2(1 + \beta)R_E} = -\frac{100\,\text{k}\Omega}{203.467\,\text{k}\Omega} = -0.49$$

即共模信号被抑制。


差模信号，假设Vin+有一个微小的电压增量，引起基极电流i<sub>b1</sub>变化，而电路对称所以另一个管子也有一个变化量，在发射极两个管子引起的变化正好大小相等方向相反，在动态分析中可以把两个管子的发射极看做接地（电压不变点）。

$$i_{b\_diff} = \frac{V_{diff} - V_{diff,N}}{2(R_{B1} + r_{be})} = \frac{V_{diff}}{2(R_{B1} + r_{be})}$$
$$u_{0+\_dif} = -\beta i_{b\_diff} R_{C1}$$
$$u_{0-\_dif} = \beta i_{b\_diff} R_{C1}$$
$$A_D \text{单} = \frac{u_{0+\_dif}}{V_{diff}} = -\frac{\beta R_{C1}}{2(R_{B1} + r_{be})} = -\frac{100\,\text{k}\Omega}{2.934\,\text{k}\Omega} = -34.08$$

两个输出信号反向，如果我们差分输出可得：

$$A_D \text{双} = \frac{u_{O+\_diff} - u_{O-\_diff}}{V_{\text{diff}}} = -\frac{\beta R_{C1}}{R_{B1} + r_{be}} = -68.17$$


## 带负载

静态分析中，两个输出端电位相等，所以接入R<sub>load</sub>不会对原静态电路造成影响。

动态分析中。共模信号同理不会对原结果造成影响，不包含R<sub>load</sub>。

对于差模信号，仅在输出端改变。原动态等效图：
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.2h8guj03ip.webp)

动态分析中要熟练运用电压不变点看做接地，这一技巧，当仅有Vin+输入时，在Vout+引起电压变化+u，Vout-电压不变看做接地，即在R<sub>load</sub>左端有电压变化，同理Vin-输入时，在右端有电压变化-u。而在R<sub>load</sub>中间点处正负变化抵消，时电压不变点。因此等效电路图：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4qrhe0vwfo.webp)

解得：
$$u_{out+} = -βi_b(R_c//0.5R_{load})$$

$$A_D \text{单} = \frac{u_{O+\_diff}}{V_{diff}} = -\frac{\beta(R_C // 0.5R_{load})}{2(R_{B1} + r_{be})} = -\frac{33.33k\Omega}{2.934k\Omega} = -11.36\$$

$$A_D \text{双} = \frac{u_{O+\_diff} - u_{O-\_diff}}{V_{diff}} = -\frac{\beta(R_C // 0.5R_{load})}{R_{B1} + r_{be}}$$

与不带负载时的区别是，在分子上并联了一个0.5R<sub>load</sub>。


### 单端带载

首先静态会影响，输出端多了一个R<sub>load</sub>分流。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6bh8din521.webp)


$$U_{CQ1} = \frac{V_{CC} R_{\text{load}} - I_{CQ1} R_{\text{load}} R_{C1}}{R_{\text{load}} + R_{C1}}$$

$$A_{C \text{单}} = \frac{u_{O+,\text{com}}}{V_{\text{com}}} = -\frac{\beta (R_{c1} // R_{\text{load}})}{R_{B1} + r_{be} + 2(1 + \beta)R_E} = -\frac{50k\Omega}{203.467k\Omega} = -0.25$$
$$A_{D \text{单}} = \frac{u_{O+,\text{diff}}}{V_{\text{diff}}} = -\frac{\beta (R_{c1} // R_{\text{load}})}{2(R_{B1} + r_{be})} = -\frac{50k\Omega}{2.934k\Omega} = -17.04$$


* 输入电阻：
  1. 差模输入电阻：
    $$r_{iD} = 2(R_{B1}+r_{be})$$
    差模回路的总电阻

  2. 共模输入电阻：
    $$r_{iC} = \frac{R_{B1}+r_{be}+2(1+β)R_E}{2}$$
    左右两侧输入看进去的电阻并联

* 输出电阻：
  1. 单端：
    $$r_{out+} = R_{C1}, r_{out-} = R_{C2}$$
  2. 双端：
    $$r_{oD} =  R_{C1}+R_{C2}$$


## 共模抑制比

定义：差模增益除以共模增益。差模信号放大越大越好，共模信号越小越好。

$$CMRR = \frac{A_D}{A_C}$$

用dB表示：
  $$CMRR = \frac{A_D}{A_C} = 20 \times \log\left(\frac{A_D}{A_C}\right) dB$$

输出若为差分形式，如果电路完全对称，CMRR为无穷大。

输出为单端形式，则将前述分析结果带入：

$$CMRR = \frac{A_D}{A_C} = \frac{-\frac{\beta R_{C1}}{2(R_{B1} + r_{be})}}{\frac{\beta R_{C1}}{-R_{B1} + r_{be} + 2(1 + \beta)R_E}} = \frac{R_{B1} + r_{be} + 2(1 + \beta)R_E}{2(R_{B1} + r_{be})}$$