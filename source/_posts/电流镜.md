---
title: 电流镜
date: 2025-03-21 14:49:18
mathjax: true
categories:
  - 硬件
  - 模电
tags:
---

# 电流镜

电流镜一般指1:1电流镜，由输入电流支路、输出电流支路组成，输出电流等于输出电流。

## BJT
电流镜核心是两个晶体管的基极和发射极连在一起，以迫使两者具有相同的u<sub>BE</sub>，使其i<sub>b</sub>相等，进而保证i<sub>C</sub>。
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.2ks2v4506r.webp)


输出电流支路，当负载一端可以接地时，称为地型，否则为浮型。当输出电流为流出电流镜时，称为吐型，当输出电流流入电流镜时，称为纳型。

$$i_{IN} = i_{C1} + 2i_{B1} = (\beta + 2)i_{B1}$$

$$i_{OUT} = \beta i_{B2} = \beta i_{B1} = \frac{\beta}{\beta + 2}i_{IN}$$

## 厄利电压

理想与现实总是差距很大，我们上面的分析都是在理想晶体管的前提下进行的，理想晶体管严格遵从$I_c=βI_b$，输出伏安特性曲线是一条直线，我们知道实际晶体管的伏安特性曲线是倾斜的，随着U<sub>ce</sub>增加，I<sub>c</sub>也会增大。

仿真中画出以下电路图：
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.7i0jp02wqb.webp)

我们把R<sub>1</sub>看做控制对象，改变电阻的大小观察输出端的电流大小，理想情况，晶体管工作在放大区情况下输出端电流不会发生改变

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.3nrs627zaz.webp)

这个是仿真软件里面的理想晶体管


下图是一个实际的管子：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.3gokampi4k.webp)
可以看到尽管在放大区，电流依然在减小。


厄利电压——early voltage，描述的就是晶体管输出福安特性曲线的倾斜程度，美国工程师James M.Early发现每根输出福安特性曲线向左的延长线都会在横轴上一个负电压相交。

这个电压取绝对值记作V<sub>AF</sub>

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.3d4ycxqakk.webp)

$$i_c = i_{co} + \frac{u_{CE}}{r_{CE}} = \beta i_B + \frac{u_{CE} - U_{CES}}{r_{CE}}$$

其中r<sub>CE</sub>代表晶体管输出伏安特性中某根曲线的倾斜程度，越小越倾斜。其中定义$i_{C0} = βi_B$，I<sub>c0</sub>是饱和区与放大区边界的电流。

当我们知道i<sub>B</sub>，就可以确定一根伏安特性线，也就确定了i<sub>C0</sub>，最后确定r<SUB>CE</SUB>:

$$r_{CE} = \frac{V_{AF} + U_{CES}}{i_{CO}}$$



## MOSFET组成的电流镜

MOSFET门极没有电流，如果两个管子相同则$I_{in} = I_{out}$，并且增强型MOSFET的开启电压一般比BJT的U<sub>CES</sub>=0.3V大，所以门极电位要高一点。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.13lxuiat9u.webp)

MOSFET也有厄利效应，即U<sub>DS</sub>变化会影像输出电流。输出电流表达式为：

$$i_{OUT} = K(u_{GS} - U_{GSTH})^2 (1 + \lambda u_{DS})$$

其中$\lambda$表征输出伏安特性的倾斜程度。


## 比例电流镜

比例电流镜是电流镜的一种变体，它依靠R<sub>1</sub>和R<sub>2</sub>之间的比例关系，决定输出电流i<sub>out</sub>与输入电流i<sub>1</sub>的比值。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.7p3rlkjfrx.webp)

工作原理：

恒流源IS1迫使T1经过5mA电流，所以电阻VF2电压必然等于5V，恒流源会主动改变T1管子的G极电压，迫使I<sub>D1</sub> = 5mA，此时T1、T2管子的G极电压相同，如果两个管子的福安特性曲线相同且R2=R3，那么输出电流I<sub>out</sub> = I<sub>in</sub>，改变R2、R3的比例则输出电流比例也会改变。


分析：
1. 使用仿真软件得到MOSFET的转移特性曲线，将数据导出excel中，对其实施多项式拟合，得到曲线方程表达式。即得到管子的K、U<sub>GSTH</sub>等参数。
2. R1上的电压必然是5V，根据算出的转移特性曲线可以得到U<sub>gs</sub>、U<sub>g1</sub>。

3. 管子T2满足转移特性曲线和实现方程：
$$\begin{cases}i_{D2} = 0.0536 (u_{GS2} - 1.809)^2 \\ 7.114 = u_{GS2} + i_{D2} \times 500 \end{cases}$$
可求得i<sub>D2</sub>

图解法分析：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.9nzyeqislq.webp)


深蓝色曲线是MOSFET的专业特性曲线，红色直线是斜率倒数为R1 = 1000Ω，这是T1管满足的直线方程，与横轴交点为U<sub>G</sub>，两个管子门极电压相同因此，固定此点不变，改变斜率倒数为R3 = 500Ω，图中为绿色直线，是T2满足的直线方程。

可以看出，R3越来越小，P2点会越来越高，电流越来越大。这种比例是近似的，因为伏安特性曲线毕竟是一个曲线不是直线。



## Widlar 电流源

主要用在运放输入级中，一般输入级需要设置很小的集电极电流或者发射极电流，前述设计的电流镜需要使用较大的电阻。集成电路中制作大电阻比较困难。

Widlar 电流源，也叫微电流源。他在上述电路基础上给输出晶体管增加了一个小电阻形成的。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.2a595zsyv1.webp)


分析：

$$u_{BE1} = u_{BE2} + i_{E2} \times R_E \approx u_{BE2} + i_{OUT} \times R_E$$

根据晶体管福安特性曲线可得：
$$i_B = I_S (e^{\frac{U_{BE}}{U_T}} - 1) \approx I_S \times e^{\frac{U_{BE}}{U_T}}$$

带入两个管子：
$$U_T \times \ln \left( \frac{i_{IN}}{\beta \times I_S} \right) = U_T \times \ln \left( \frac{i_{OUT}}{\beta \times I_S} \right) + i_{OUT} \times R_E$$

最后我们往往需求是已知i<sub>out</sub>，要计算R<sub>E</sub>的值。

解得：
$$R_E = \frac{U_T}{i_{OUT}} \times \ln \left( \frac{i_{IN}}{i_{OUT}} \right)$$


### 举例——多路并联Widlar电流源

要求：设计一个BJT组成的多路并联Widlar微电流源，供电电压为10V，电路中最大的电阻不能超过3KΩ，实现3路输出，电流分别为50μA，100μA，200μA。


1. 确定Rc并求解输入级电流i<sub>IN</sub>。

    我们就把$R_C = 3KΩ$输入级电流越小越容易实现小电流。通过输入级回路可列出方程：
    $$i_{IN} = \frac{V_{CC1} - U_{BEQ0}}{R_C} = \frac{10V - 0.7V}{3k\Omega} = 3.1mA$$

2. 输出级发射极电阻由上面公式确定：

    $$R_{E1} = \frac{U_T}{i_{OUT1}} \times \ln \left( \frac{i_{IN}}{i_{OUT1}} \right) = \frac{26 \, \text{mV}}{50 \, \mu \text{A}} \times \ln \left( \frac{3.1 \, \text{mA}}{50 \, \mu \text{A}} \right) = 2146\Omega$$

    $$R_{E2} = \frac{U_T}{i_{OUT2}} \times \ln \left( \frac{i_{IN}}{i_{OUT2}} \right) = \frac{26 \, \text{mV}}{100 \, \mu \text{A}} \times \ln \left( \frac{3.1 \, \text{mA}}{100 \, \mu \text{A}} \right) = 892\Omega$$
    $$R_{E3} = \frac{U_T}{i_{OUT3}} \times \ln \left( \frac{i_{IN}}{i_{OUT3}} \right) = \frac{26 \, \text{mV}}{200 \, \mu \text{A}} \times \ln \left( \frac{3.1 \, \text{mA}}{200 \, \mu \text{A}} \right) = 356\Omega$$
    仿真结果：
    ![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.32i4o0i6tq.webp)



## 威尔逊电流镜——Wilson Current Mirror

上面讲的最基础的电流镜有两个缺点：

1. 输出电流是输入电流的β/（β+2）倍，与β相关。对MOSFET组成的电流镜没有这个缺点。

2. 输出级无法保持恒流，输出电流与晶体管的C、E压降密切相关，压降越大，输出电流越大。输出级一般有一个电压源，当负载电阻变化时，晶体管CE压降也会改变，从而导致实际输出不是恒流。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.8ojv1x8asj.webp)

    
改进核心是增加了第三个晶体管Q3，通过Q3的作用可以保证Q1和Q2两个晶体管的U<sub>CEQ</sub>非常接近，Q1是1.4V，Q2是0.7V，它们不再随负载电阻大小变化而变化，输出电流就会相对稳定。

假设三个管子都相同，i<sub>B</sub>三个管子都一样。通过分析可得：
$$i_{IN} = \beta i_B + \frac{\beta i_B + 2i_B}{1 + \beta} 
= i_B \left( \beta + \frac{\beta + 2}{1 + \beta} \right) 
= i_B \frac{\beta^2 + 2\beta + 2}{1 + \beta}$$


$$
i_{OUT} = i_B \frac{\beta^2 + 2\beta}{1 + \beta}
$$

$$i_{OUT} = i_{IN} \frac{\beta^2 + 2\beta}{\beta^2 + 2\beta + 2}$$

输出电流会略小于输入电流，且两者误差约为$2/\beta^2$，前述基础版电流镜输出电流误差远大于威尔逊电流镜。

仿真如下：
第一个图是基础版电流镜，控制负载电阻大小改变观察输出电流变化
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.13lxxxsr5b.webp)

第二个图是威尔逊电流镜
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4jo9q14kk1.webp)

可以看到，改变负载电阻大小，只要管子工作在放大区，输出电流改变很小。

### 四晶体管威尔逊电流镜

在三晶体管的基础上增加第四个晶体管形成了4晶体管威尔逊电流镜

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.86ttdkga23.webp)
注意这个分析过程，从Q3开始往下分析，其中Q1、Q2、Q3的U<sub>CQ</sub>是确定的不会随负载变化，不需要考虑厄利效应。对于Q4因为他与负载相连集电极电压随负载改变，所以要考虑厄利效应，它的i<sub>c</sub>=βi<sub>b</sub>不成立。
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.13lxxyvcld.webp)

$$i_{OUT} = i_{IN} \frac{\beta^2 + 2\beta}{\beta^2 + 2\beta + 2}$$


### MOSFET威尔逊电流镜

使用MOSFET管代替BJT管也可以形成威尔逊电流镜。注意：MOSFET没有门极电流，输入电流源的最低电位要很高，一般大于2倍的MOSFET开启电压U<sub>GSTH</sub>。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4ub3j8y7lu.webp)

把输入电流源换做一个电阻，T3管子有转移特性曲线和直线方程成立：

$$
i_{D3} = K (u_{GS3} - U_{GSTH})^2
$$

$$V_1 = i_{D3}R_1+u_{GS2}+u_{GS3}$$

解得：
$$
R_1 = \frac{V_1 - 2\left(U_{GSTH} + \sqrt{\frac{i_{D3}}{K}}\right)}{i_{D3}}
$$

## 电流源的顺从电压和输出阻抗

电流源一端为OUT另一端为COM，与负载连接的端子一定是OUT端，COM端则一般接固定电压源或者GND。

顺从电压：电流源在保持输出电流在能够接受的范围内时，COM端和OUT端之间的需要的最小电位差，用绝对值表示。

顺从电压越小越好，在相同的外部供电电压下，顺从电压越小，留给负载电阻的电压变化范围就越大。

示例计算：P195



## 恒流源 (Constant Current Source)

一个电路或者器件的某个端子，在一定范围内的外电势作用下，能够流出或者流进恒定的电流，称为恒流源。一般来说有三类：1. 简易晶体管恒流源 2. 压流转换电路 3.  专用的恒流源

下图是由PNP管组成的简易晶体管电流源。


![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.13lxywecj6.webp)!

可列出表达式：

$$U_{DZ} = U_{BE}+i_ER_{SET}$$
$$
i_{OUT} =  \frac{\beta}{1 + \beta} \times \frac{U_{DZ} - U_{BE}}{R_{SET}}$$

输出电流的设置主要靠R<sub>SET</sub>。
这个电流源的顺从电压大约是1.4V（小有疑问？？？？）

一般实际应用中，二极管三极管、电阻R<sub>1</sub>生产厂家已经产好，R<sub>SET</sub>靠用户设定。影响输出电流的还有外部供电电压VCC，负载电阻R<sub>L</sub>，以及温度。

这个电流源对外部条件改变很敏感：

1. VCC固定，温度确定管子I<sub>B</sub>确定，影响输出电流的只剩U<sub>CE</sub>，即输出电流的稳定性主要取决于晶体管的厄利效应。

2. 当负载电阻稳定，温度固定，VCC的增大将直接引起二极管工作状态的变化：电流变大，U<sub>DZ</sub>变大，导致晶体管I<sub>E</sub>变大，输出电流也就增大。U<sub>DZ</sub>的稳定性直接决定输出电流的稳定性。

3. 温度稳定性不高

