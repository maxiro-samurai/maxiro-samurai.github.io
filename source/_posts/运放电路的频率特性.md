---
title: 运放电路的频率特性
date: 2025-07-17 15:10:02
mathjax: true
categories:
  - 硬件
  - 模电
tags:
---


# 运放开环增益简化表达


运放的开环增益是随频率变化而变化的，我们之前在数据手册中看过。

运放开环增益可以表达为：

$$\dot A_{uo}(f) = A_{uom}\times \frac{1}{1+j\frac{f}{f_H}}$$



模代表幅频特性：

$$A_{uo}(f) = A_{uom} \times \frac{1}{\sqrt{1+(\frac{f}{f_H})^2}} $$

幅角代表相移：

$$φ_{uo}(f) = - arctan(\frac{f}{f_H}) $$


## 简化开环增益


我们之前学过方框图法解负反馈电路，反馈系数F，衰减系数为M，闭环与开环增益的关系式


$$
\dot A_{uf}(f) = \frac {\dot u_O}{u_I} = \frac {M\times \dot A_{uo}(f)}{1+F\times \dot A_{uo}(f)}
$$ 


当开环增益很大时，分母的1可以省略，即闭环增益与低频处的开环增益无关。

简化：

$$\dot A_{uo}(f) = A_{uom}\times \frac{1}{0+j\frac{f}{f_H}} = -j \times A_{uom}\times \frac{f_H}{f}$$


## 最终简化

我们在厂商给的数据手册中最经常使用的是GBW、UGBW，根据GBW定义可得


$$\dot A_{uo}(f) = -j\times A_{uom}\times \frac{f_H}{f} = -j\times \frac{GBW}{f}$$



## 如何求 -ydB带宽？

一个放大电路，M、F已知求-ydB带宽。

根据定义：

$$A_{uf}(x) = A_{ufm}-y $$
单位dB


可得
$$A_{uf}(x) = 10^{-\frac{y}{20}}\times A_{ufm}$$

A<sub>ufm</sub>为中频带增益。




将简化的开环增益表达式带入闭环增益中，可得模和相角
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.39lh3tdr4c.png)


![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.5q7piqlf6j.webp)



所以可得：

$$f_{Hf-3dB} = f_{Hf} = F\times GBW$$

即-3dB带宽。


注意：这两个表达式在超过f<sub>Hf</sub>后最好不要再使用。因为实际运放曲线在接近UGBW时已经不再是一条直线，不能用简化模型表达。

上面的式子联立可得：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6ikl0hbcqg.webp)


上面这个公式在已知反馈系数情况下，能够求得任意衰减dB下的带宽。

举例：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6bhe4yqjgc.webp)
反向比例器


1.求解系数：
从电路可以看出 $F = \frac{R_g}{R_f+R_g} = \frac{1}{11}$，$M = - \frac {R_f}{R_f+R_g} = \frac{10}{11}$

2.阅读芯片手册得到增益带宽积GBW
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.3gopz6hd7v.webp)


GBW = 10MHZ

3.根据公式计算
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.92qgd2j9tz.webp)

即可以算出-1dB带宽，这个值表示在输入信号频率小于462.6kHz时，可以保证闭环增益在-8.9125 - -10倍。

# 负反馈放大电路产生自激振荡的条件

运放组成的负反馈放大电路，当开环增益A<sub>uo</sub>和反馈网络本身的相移为0°时，整个环路永远是负反馈。
但是当环路整个的附加相移φ<sub>A</sub>+φ<sub>F</sub> = -180°，原本的负反馈会变成正反馈。

除了相位条件外还需具备幅度条件，整个环路增益必须大于1，才能使得很小的信号越来越大。
即：     
$$A_{uo}F>1$$

## 理论与实际

上面的分析是电路产生震荡的理论依据，我们经常发现理论与实际不符，理论上不会出现震荡的放大电路，实际做出来之后，它出现了自激振荡。

原因：
实际电路中存在杂散电容。

1. 同一层的两个相邻节点间。比如某根信号线，和周边的覆铜 GND 之间，以及和周边的焊点之间。

2. 不同层上下之间。比如元件层的线，和焊接层的大面积 GND 之间。

3. 器件的两个管脚之间。

## 如何避免?

1. 选择合适的增益，选择合适的增益电阻

对于任意一个选定的运放，在它能够实现的最小增益基础上，适当提高闭环增益，可以有效提高系统稳定性。

增益电阻尽量选择小的，降低反向输入端C<SUB>IN-</SUB>的作用。

2. 设计PCB时，尽量减小杂散电容，特别是C<sub>IN-</sub>。

铺铜这个操作，本质目的是增大地线面积，进而减小地线电阻和电感。但是铺铜也会带来两个问题：第一，它与同层信号线之间形成了很长很长的近距离间隙，即大电容。第二，与其他层信号线形成了层间电容，这些杂散电容，都会引起系统不稳定。

所以我们在实际设计运放电路的时候，在运放负输入引脚、输出脚及其下方都不要铺铜，还有就是同层的铺铜离这些引脚、连线的间距大点。

3. 尽量不要驱动大电容负载，必须驱动大电容负载的，使用裕度大的运放。或者串联隔离电阻。

# 频率失真

非线性失真：“输入-输出”关系是曲线，当输入为单一频率正弦波时，输出一定不是正弦波，而是除基波外包含谐波。

线性失真：当输入为多个正弦波叠加形成复合波，放大电路对每个正弦波都不产生非线性失真，但是对每个正弦波的增益或延时不同，造成输出波形变形。（幅度和相位）




# 频率特性分析方法

频域分析法，最主要采用理论分析。

例：一阶低通滤波器

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.26lsu15ofp.webp)

理论分析计算可得：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4xuv23uosr.webp)

幅频特性与相频特性：

$$ |\dot A_{uf}| = -\frac{R_f}{R_g}\times \frac{1}{\sqrt{1^2+\frac{f}{f_0}^2}}$$

$$ \phi  = 180° - tan^{-1}(\frac{f}{f_0})$$

其中$f_0 = \frac{1}{2\pi R_f C_3} $

仿真得到幅频与相频特性曲线：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6pntx0wg0y.webp)

# 滤波器

滤波是指对不同频率输入信号，实施不同的增益和相移，以形成输出。滤波器是执行这种动作的硬件设备或者软件程序。


# 无源滤波与有源滤波

无源滤波：无需外部供电即可工作，包括电阻、电容、电感和变压器。

优点：
1. 可工作在大电压、电流情况下。
2. 在超高频率时，无源器件有天生优势。
3. 简单滤波情况下可选择
4. 成本便宜

有源滤波：必须有额外电能供应才能工作的器件

优点：

1. 可以引入负反馈、可以引入放大环节，因此可以实现极为复杂的滤波器，且能轻松应对小信号。
2. 可以轻松实现多级滤波器的级联，而无源滤波器各级之间的互相影响是极为复杂的多级级联非常困难。
3. 对超低频率，有源滤波器有天生优势。
4. 电路计算更简单。
5. 带载能力强于无源滤波

## 有源滤波器

实现方法有3类：
1. 运放组成的有源滤波器

2. 状态变量型集成有源滤波器

3. 开关电容滤波器

功能分类：
1. 低通滤波器
2. 带通滤波器
3. 带阻滤波器
4. 全通滤波器

  
## 模拟滤波器传递函数和阶数

系统传递函数就是系统输出函数u<sub>o</sub>(t)与u<sub>i</sub>(t)的比值的拉氏变换。
$$A(S) = \frac {U_o (s)}{U_i (S)}$$


上面那个例子也能写成传递函数形式

$$A(S) = - \frac {R_f}{R_g}\times \frac{1}{1+SR_fC_3} = A_m \times \frac {1}{1+aS}$$


滤波器更通用表达式：
$$A(S) = A_m \times \frac{1+m_1S+m_2S^2+...+m_mS^m}{1+n_1S+n_2S^2+...+n_nS^n}$$

n为滤波器的阶数




上限截止频率f<sub>H</sub>: 与之前晶体管频率特性时学的定义一样。

下限截止频率f<sub>L</sub>：同上。


特征频率f<sub>0</sub>: 特征频率是使传递函数变得最简单的点。

定义特征频率的相移规则为：阶数每增加1阶，对于低通，特征频率点处的相移顺时针转动45°（滞后45°），对于高通，则逆时针转动45°（超前45°）。


中心频率f<sub>c</sub>: 窄带通滤波器中，增益最大值处，或者相移为0度或者 360 度的整数倍时的频点，称为中心频率。陷波器中，增益最小值处，或者相移为 0度或者 360 度的整数倍时的频点，称为中心频率。

## 一阶滤波器
### 一阶低通滤波器

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.6ikm1vg3pn.webp)

直接写出传函：

$$A(S) = (1+\frac{R_f}{R_g})\times \frac{1}{1+SRC}$$

$S = jw, w_0 = 1/RC$


增益的模：
$$|\dot A(jw)| = A_m\times \frac{1}{\sqrt{1+\frac{f}{f_0}^2}}$$


当频率极低时，增益接近A<sub>m</sub>，随着频率逐渐增大到f = f<sub>0</sub>，增益变为0.707A<sub>m</sub>。随后随着频率增大，增益会以-20dB/10倍频的速率下降。这个斜率是通过计算得到的，这里不细推，需要知道n阶滤波器，衰减斜率按照-20ndB速率下降。


相移：

$$\phi (f)  = -tan^{-1}\frac {f}{f_0}$$


### 一阶高通滤波器

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.45hzkov5r6.webp)

同理可以得到：

$$|\dot A(f)| = A_m \times \frac{1}{\sqrt{1 + (\frac{f_0}{f})^2}}$$

$$ \phi (f) = tan^{-1}{\frac{f_0}{f}}$$



### 反向输入的一阶低通

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.58hovmztp0.webp)

可直接写出增益表达式：

$$|\dot A(jw)| = -A_m\times \frac{1}{\sqrt{1+\frac{f}{f_0}^2}}$$


$$\phi (f) = 180° - tan^{-1}{\frac{f}{f_0}}$$

其中$A_{m} = -\frac {R}{R_g}, f_0 = \frac{1}{2\pi RC}$


### 反向输入的一阶高通
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4606dceea.webp)

幅频与相频表达式：

$$|\dot A(jw)| = -A_m\times \frac{1}{\sqrt{1+\frac{f_0}{f}^2}}$$

$$\phi (f) = -180° + tan^{-1}{\frac{f_0}{f}}$$



### 一阶全通滤波器

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.3k8bz2yxsx.webp)

这个电路求解有多种思路，可以使用叠加原理、虚短虚断，可得：

$$\dot A(f) = \frac{1-j\frac{f}{f_0}}{1+j\frac{f}{f_0}}$$

幅频：

$$|\dot A(f)| = \frac{\sqrt{1^2+(-j\frac{f}{f_0})^2}}{\sqrt{1^2+(j\frac{f}{f_0})^2}}$$

相角： 


$$\phi (f) = \phi (分子) - \phi (分母) = -2tan^{-1}\frac{f}{f_0}$$



相移为负值，所以是滞后型全通滤波器，上面左图。 右图为滞后型，同样可以求得：


$$\dot A(f) = \frac{1+j\frac{f_0}{f}}{1-j\frac{f_0}{f}}$$


$$\phi (f) = \phi (分子) - \phi (分母) = 2tan^{-1}\frac{f_0}{f}$$


例：设计一个滤波器，要求输入信号幅度100mV，频率1000hz的正弦波，输出为同频正弦波并且相位超前45°，幅度为1V。

分析：需要超前相位，前级可以选择超前相位的全通滤波器，幅度放大10倍后级接一个10倍放大器即可。主要先设计这个全通滤波器。

首先我们已知相移要求45°可得：

$$\phi (1000) = \phi (分子) - \phi (分母) = 2tan^{-1}\frac{f_0}{1000} = 45°$$
得
$$f_0 = \frac{1}{2\pi RC } = 414.2Hz$$

选择RC参数：

1. 实际选择电阻选择不能太大也不能太小，选择R = 1KΩ是一个保险值。

$$C = \frac{1}{2\pi R f_0} = 0.3844\mu F$$
选择一个接近的电容值 C = 0.33μF
重新计算电阻值
$$R = \frac{1}{2\pi C f_0} = 1170 Ω$$
我们选择R = 1180Ω

2. 对全通滤波器中另外两个电阻值必须相等，且两者并联最好等于R。
所以R<sub>g</sub> = R<sub>f</sub> = 2.37kΩ

3. 后级放大电路，选择同相10倍放大，电阻比例1:9，选择R = 1kΩ 和 9.09kΩ

运放选择40MHz带宽的OPA1611，至此设计完毕，对电路进行仿真。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.102hmsqb3x.webp)

输入与输出电压

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.7axhkoj400.webp)

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.7pm52ez86.webp)

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.8ok0opwlub.webp)

可以算出相位超前：
$$360° \times  \frac{123.1\mu s}{1000 \mu s} = 44.316°$$

与理论计算相吻合。


### 选电容为何不是选电感

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.8hgstaq46u.webp)

电感与电阻也能组成低通滤波器，下面分析为何不用。

$$\dot A(f) = \frac {1}{1+\frac{f}{f_0}}, f_0 = \frac{R}{2\pi L}$$

考虑到运放噪声与输出电流，电阻不能太大也不能太小，普遍一个安全标准 1KΩ。

那么决定特征频率的值就是电感量了，由于制造工艺，多数电感在1nH~100mH之间。据此，f<sub>0</sub> = 159GHz~1.59MHz 
一般运放的工作频率0~100MHz 

所以电感构成的滤波器，只能工作在截止频率比较大的场合。


电容由于制造工艺，可以1pF~1000μF，所以特征频率 0.159Hz~159MHz，恰好符合运放工作频率。


### 压控滤波器

这种滤波器的截止频率可以由外部直流电压控制，利用乘法器或者压控增益放大器可以实现此功能。

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.4cl7hb6c20.webp)

利用虚短虚断可以求出：

$$\dot A(jw) = -\frac{R}{R_1} \times \frac{1}{1+jw\frac{RC}{KU_c}}$$

可以看出这个表达式是一阶低通滤波器，上限截止频率为$f_H = \frac {KU_C}{2\pi RC}$

我们看这个电路与一阶低通滤波器的区别，就是在后级增加了一个乘法器，乘法器输出端电压接反馈环路中。使用外部的DAC设置U<sub>C</sub>就可以改变低通滤波器的特征频率，在一些场合下非常有用。

后级也不一定是一个乘法器，我们可以用一个电阻网络或者比例器模拟乘法器。

下面举例：

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.8l0es6a254.webp)

我们把后级电阻网络使用戴维宁等效或者看做一个压控电压源

![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.5trck3xwn7.webp)

其中
$$KU_C  = \frac {R_4}{R_3 + R_4} = 0.5$$
$$ R_o = R3//R4 = 500Ω$$

带入公式可得
$$f_H = 5305Hz$$

仿真结果可看到结果吻合
![image](https://github.com/maxiro-samurai/picx-images-hosting/raw/master/image.2ks8ngfyit.webp)


还可以把后级换成一个比例放大电路，这里不再分析，需要注意最终的特征频率与放大倍数和使用的运放带宽都有关系，运放随着频率增加放大倍数会出现衰减，因此后级运放的带宽要尽量高于特征频率。
